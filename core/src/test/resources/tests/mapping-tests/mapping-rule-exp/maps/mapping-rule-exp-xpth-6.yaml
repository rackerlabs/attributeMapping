---
mapping:
  version: RAX-1
  description: |-
    Simple policy where we select required attributes via an XPath.
  namespaces:
    foo: urn:oasis:names:tc:SAML:2.0:protocol
  rules:
  - local:
      user:
        domain: "{Pts(/foo:Response/saml2:Assertion/saml2:AttributeStatement/saml2:Attribute[@Name='domain']/saml2:AttributeValue[1])}"
        name:   "{Pts(/foo:Response/saml2:Assertion/saml2:Subject/saml2:NameID)}"
        email:  "{Pts(/foo:Response/saml2:Assertion/saml2:AttributeStatement/saml2:Attribute[@Name='email']/saml2:AttributeValue[1])}"
        roles:  "{Pts(/foo:Response/saml2:Assertion/saml2:AttributeStatement/saml2:Attribute[@Name='roles']/saml2:AttributeValue)}"
        expire: "{Pts(/foo:Response/saml2:Assertion/saml2:Subject/saml2:SubjectConfirmation/saml2:SubjectConfirmationData/@NotOnOrAfter)}"
